
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Predicting Car Prices}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \subsubsection{Introduction}\label{introduction}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{math} \PY{k}{as} \PY{n+nn}{m}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{from} \PY{n+nn}{operator} \PY{k}{import} \PY{n}{itemgetter}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{KFold}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{mean\PYZus{}squared\PYZus{}error}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k}{import} \PY{n}{KNeighborsRegressor}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        
        \PY{c+c1}{\PYZsh{} Decide about the database column headers by getting detail data insight at: https://archive.ics.uci.edu/ml/datasets/automobile}
        \PY{n}{col\PYZus{}name} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symboling}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{normalized\PYZhy{}losses}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{make}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fuel\PYZhy{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aspiration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZhy{}of\PYZhy{}doors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{body\PYZhy{}style}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{drive\PYZhy{}wheels}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{engine\PYZhy{}location}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wheel\PYZhy{}base}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{height}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{engine\PYZhy{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{num\PYZhy{}of\PYZhy{}cylinders}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{engine\PYZhy{}size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fuel\PYZhy{}system}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{stroke}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{compression\PYZhy{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{peak\PYZhy{}rpm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \subsubsection{Getting Information About the
Dataset}\label{getting-information-about-the-dataset}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{cars} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./databank/import\PYZhy{}85.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{names}\PY{o}{=}\PY{n}{col\PYZus{}name}\PY{p}{)}
        \PY{n}{cars}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}2}]:}    symboling normalized-losses         make fuel-type aspiration num-of-doors  \textbackslash{}
        0          3                 ?  alfa-romero       gas        std          two   
        1          3                 ?  alfa-romero       gas        std          two   
        2          1                 ?  alfa-romero       gas        std          two   
        3          2               164         audi       gas        std         four   
        4          2               164         audi       gas        std         four   
        
            body-style drive-wheels engine-location  wheel-base  {\ldots}    engine-size  \textbackslash{}
        0  convertible          rwd           front        88.6  {\ldots}            130   
        1  convertible          rwd           front        88.6  {\ldots}            130   
        2    hatchback          rwd           front        94.5  {\ldots}            152   
        3        sedan          fwd           front        99.8  {\ldots}            109   
        4        sedan          4wd           front        99.4  {\ldots}            136   
        
           fuel-system  bore  stroke compression-rate horsepower  peak-rpm city-mpg  \textbackslash{}
        0         mpfi  3.47    2.68              9.0        111      5000       21   
        1         mpfi  3.47    2.68              9.0        111      5000       21   
        2         mpfi  2.68    3.47              9.0        154      5000       19   
        3         mpfi  3.19     3.4             10.0        102      5500       24   
        4         mpfi  3.19     3.4              8.0        115      5500       18   
        
          highway-mpg  price  
        0          27  13495  
        1          27  16500  
        2          26  16500  
        3          30  13950  
        4          22  17450  
        
        [5 rows x 26 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{cars}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 205 entries, 0 to 204
Data columns (total 26 columns):
symboling            205 non-null int64
normalized-losses    205 non-null object
make                 205 non-null object
fuel-type            205 non-null object
aspiration           205 non-null object
num-of-doors         205 non-null object
body-style           205 non-null object
drive-wheels         205 non-null object
engine-location      205 non-null object
wheel-base           205 non-null float64
length               205 non-null float64
width                205 non-null float64
height               205 non-null float64
curb-weight          205 non-null int64
engine-type          205 non-null object
num-of-cylinders     205 non-null object
engine-size          205 non-null int64
fuel-system          205 non-null object
bore                 205 non-null object
stroke               205 non-null object
compression-rate     205 non-null float64
horsepower           205 non-null object
peak-rpm             205 non-null object
city-mpg             205 non-null int64
highway-mpg          205 non-null int64
price                205 non-null object
dtypes: float64(5), int64(5), object(16)
memory usage: 41.7+ KB
None

    \end{Verbatim}

    \subsubsection{Select Columns with Continuous Data
Values}\label{select-columns-with-continuous-data-values}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c+c1}{\PYZsh{} Using data info available at: http://archive.ics.uci.edu/ml/machine\PYZhy{}learning\PYZhy{}databases/autos/imports\PYZhy{}85.names}
        \PY{n}{col\PYZus{}vals} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{normalized\PYZhy{}losses}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wheel\PYZhy{}base}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{height}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{stroke}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{compression\PYZhy{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{peak\PYZhy{}rpm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{cars\PYZus{}num} \PY{o}{=} \PY{n}{cars}\PY{p}{[}\PY{n}{col\PYZus{}vals}\PY{p}{]}
        \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:}   normalized-losses  wheel-base  length  width  height  curb-weight  bore  \textbackslash{}
        0                 ?        88.6   168.8   64.1    48.8         2548  3.47   
        1                 ?        88.6   168.8   64.1    48.8         2548  3.47   
        2                 ?        94.5   171.2   65.5    52.4         2823  2.68   
        3               164        99.8   176.6   66.2    54.3         2337  3.19   
        4               164        99.4   176.6   66.4    54.3         2824  3.19   
        
          stroke  compression-rate horsepower peak-rpm  city-mpg  highway-mpg  price  
        0   2.68               9.0        111     5000        21           27  13495  
        1   2.68               9.0        111     5000        21           27  16500  
        2   3.47               9.0        154     5000        19           26  16500  
        3    3.4              10.0        102     5500        24           30  13950  
        4    3.4               8.0        115     5500        18           22  17450  
\end{Verbatim}
            
    \subsubsection{Prepare Data for Missing Value Fill-up by Replacing
Special
Characters}\label{prepare-data-for-missing-value-fill-up-by-replacing-special-characters}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{} As seen above, the dataframe carries \PYZdq{}?\PYZdq{}. Replace it with null value}
        \PY{n}{cars\PYZus{}num} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{?}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{NaN}\PY{p}{)}
        \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:}   normalized-losses  wheel-base  length  width  height  curb-weight  bore  \textbackslash{}
        0               NaN        88.6   168.8   64.1    48.8         2548  3.47   
        1               NaN        88.6   168.8   64.1    48.8         2548  3.47   
        2               NaN        94.5   171.2   65.5    52.4         2823  2.68   
        3               164        99.8   176.6   66.2    54.3         2337  3.19   
        4               164        99.4   176.6   66.4    54.3         2824  3.19   
        
          stroke  compression-rate horsepower peak-rpm  city-mpg  highway-mpg  price  
        0   2.68               9.0        111     5000        21           27  13495  
        1   2.68               9.0        111     5000        21           27  16500  
        2   3.47               9.0        154     5000        19           26  16500  
        3    3.4              10.0        102     5500        24           30  13950  
        4    3.4               8.0        115     5500        18           22  17450  
\end{Verbatim}
            
    \subsubsection{Convert All Values to Same Data
Type}\label{convert-all-values-to-same-data-type}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{} Convert all columns of the dataframe to float data type}
        \PY{n}{cars\PYZus{}num} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} Check for all columns data type}
        \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 205 entries, 0 to 204
Data columns (total 14 columns):
normalized-losses    164 non-null float64
wheel-base           205 non-null float64
length               205 non-null float64
width                205 non-null float64
height               205 non-null float64
curb-weight          205 non-null float64
bore                 201 non-null float64
stroke               201 non-null float64
compression-rate     205 non-null float64
horsepower           203 non-null float64
peak-rpm             203 non-null float64
city-mpg             205 non-null float64
highway-mpg          205 non-null float64
price                201 non-null float64
dtypes: float64(14)
memory usage: 22.5 KB

    \end{Verbatim}

    \subsubsection{Select Target Column}\label{select-target-column}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{target\PYZus{}col} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \subsubsection{Remove Null Values from Target
Columns}\label{remove-null-values-from-target-columns}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{cars\PYZus{}num} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{cars\PYZus{}num}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:} 0
\end{Verbatim}
            
    \subsubsection{Check for Null Values in Other
Columns}\label{check-for-null-values-in-other-columns}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} normalized-losses    37
        wheel-base            0
        length                0
        width                 0
        height                0
        curb-weight           0
        bore                  4
        stroke                4
        compression-rate      0
        horsepower            2
        peak-rpm              2
        city-mpg              0
        highway-mpg           0
        price                 0
        dtype: int64
\end{Verbatim}
            
    \subsubsection{Fill out Missing Column
Values}\label{fill-out-missing-column-values}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{c+c1}{\PYZsh{} Fill out the missing values with column mean}
         \PY{n}{cars\PYZus{}num} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Check for no null values}
         \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} 0
\end{Verbatim}
            
    \subsubsection{Feature Scaling}\label{feature-scaling}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{temp\PYZus{}target} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{cars\PYZus{}num} \PY{o}{=} \PY{p}{(}\PY{n}{cars\PYZus{}num} \PY{o}{\PYZhy{}} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n}{cars\PYZus{}num}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{temp\PYZus{}target}
         \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:}    normalized-losses  wheel-base    length     width    height  curb-weight  \textbackslash{}
         0           0.000000   -0.297289 -0.080612 -0.152911 -0.413889    -0.002974   
         1           0.000000   -0.297289 -0.080612 -0.152911 -0.413889    -0.002974   
         2           0.000000   -0.125277 -0.044791 -0.033253 -0.113889     0.103698   
         3           0.219895    0.029242  0.035806  0.026577  0.044444    -0.084820   
         4           0.219895    0.017580  0.035806  0.043671  0.044444     0.104086   
         
                bore    stroke  compression-rate  horsepower  peak-rpm  city-mpg  \textbackslash{}
         0  0.099492 -0.274716         -0.072767    0.035528 -0.047995 -0.116086   
         1  0.099492 -0.274716         -0.072767    0.035528 -0.047995 -0.116086   
         2 -0.464793  0.101474         -0.072767    0.236463 -0.047995 -0.171642   
         3 -0.100508  0.068141         -0.010267   -0.006528  0.156087 -0.032753   
         4 -0.100508  0.068141         -0.135267    0.054220  0.156087 -0.199420   
         
            highway-mpg    price  
         0    -0.097015  13495.0  
         1    -0.097015  16500.0  
         2    -0.123331  16500.0  
         3    -0.018068  13950.0  
         4    -0.228594  17450.0  
\end{Verbatim}
            
    \subsubsection{Develop Univariate Model}\label{develop-univariate-model}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{} Set up a function that develop model and return RMSE}
         
         \PY{k}{def} \PY{n+nf}{knn\PYZus{}train\PYZus{}test}\PY{p}{(}\PY{n}{train\PYZus{}col}\PY{p}{,} \PY{n}{test\PYZus{}col}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}    
         
         \PY{c+c1}{\PYZsh{} Randomize the data }
             \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{shuflled\PYZus{}idx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}
             \PY{n}{data\PYZus{}rand} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{reindex}\PY{p}{(}\PY{n}{shuflled\PYZus{}idx}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Divide the data set 50/50 between the training and test set }
             \PY{n}{break\PYZus{}pt} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
             \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{data\PYZus{}rand}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n}{break\PYZus{}pt}\PY{p}{]}
             \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{data\PYZus{}rand}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{break\PYZus{}pt}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
             
         \PY{c+c1}{\PYZsh{} Defining the Training and Test Set}
             \PY{n}{train\PYZus{}features} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
             \PY{n}{train\PYZus{}target} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
             \PY{n}{test\PYZus{}features} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
             \PY{n}{test\PYZus{}target} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Develop KNeighbor Regression}
             \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{p}{)}     
             \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}features}\PY{p}{,} \PY{n}{train\PYZus{}target}\PY{p}{)}
             \PY{n}{predictions} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}features}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Calculate the model error matrix}
             \PY{n}{mse\PYZus{}val} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{test\PYZus{}target}\PY{p}{,} \PY{n}{predictions}\PY{p}{)}
             \PY{n}{rmse} \PY{o}{=} \PY{n}{m}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mse\PYZus{}val}\PY{p}{)}
             \PY{k}{return} \PY{n}{rmse}
         
         \PY{n}{trn\PYZus{}col} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{columns}
         \PY{n}{tst\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{rmse\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{trn\PYZus{}col}\PY{p}{:}
             \PY{n}{rmse\PYZus{}dict}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{knn\PYZus{}train\PYZus{}test}\PY{p}{(}\PY{n}{col}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cars\PYZus{}num}\PY{p}{)}
         \PY{n}{rmse\PYZus{}dict}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} \{'bore': 6822.548760309449,
          'city-mpg': 4998.449685132381,
          'compression-rate': 6628.568722823954,
          'curb-weight': 4422.255745566961,
          'height': 7857.62725440702,
          'highway-mpg': 4675.883732044671,
          'horsepower': 4011.999335643016,
          'length': 5455.571648177668,
          'normalized-losses': 7338.850271289094,
          'peak-rpm': 7698.121918961792,
          'stroke': 7965.733340477825,
          'wheel-base': 5486.805326526539,
          'width': 4931.242155725067\}
\end{Verbatim}
            
    \subsubsection{Univariate Model with Multiple
Clusters}\label{univariate-model-with-multiple-clusters}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{} Defining the number of split values as variable}
         \PY{n}{cluster\PYZus{}num} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Set up function that develop model that can handle multiple split values and generate RMSE}
         \PY{k}{def} \PY{n+nf}{knn\PYZus{}train\PYZus{}test\PYZus{}splits}\PY{p}{(}\PY{n}{train\PYZus{}col}\PY{p}{,} \PY{n}{test\PYZus{}col}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:} 
             
         \PY{c+c1}{\PYZsh{} Randomize the data }
             \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{shuflled\PYZus{}idx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}
             \PY{n}{data\PYZus{}rand} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{reindex}\PY{p}{(}\PY{n}{shuflled\PYZus{}idx}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Divide the data set 50/50 between the training and test set }
             \PY{n}{break\PYZus{}pt} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
             \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n}{break\PYZus{}pt}\PY{p}{]}
             \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{break\PYZus{}pt}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Defining the Training and Test Set}
             \PY{n}{train\PYZus{}features} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
             \PY{n}{train\PYZus{}target} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
             \PY{n}{test\PYZus{}features} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
             \PY{n}{test\PYZus{}target} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Develop KNeighbor Regression}
             \PY{n}{rmse\PYZus{}val} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{cluster\PYZus{}num}\PY{p}{:}
                 \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{n}{n\PYZus{}neighbors} \PY{o}{=} \PY{n}{i}\PY{p}{)} 
                 \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}features}\PY{p}{,} \PY{n}{train\PYZus{}target}\PY{p}{)}
                 \PY{n}{predictions} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}features}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Calculate the model error matrix}
                 \PY{n}{mse\PYZus{}val} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{test\PYZus{}target}\PY{p}{,} \PY{n}{predictions}\PY{p}{)}
                 \PY{n}{rmse\PYZus{}val}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{m}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mse\PYZus{}val}\PY{p}{)}
             \PY{k}{return} \PY{n}{rmse\PYZus{}val}
         
         \PY{c+c1}{\PYZsh{} Establish RMSE dictionary with varying clusters for every feature of the dataset}
         \PY{n}{RMSE\PYZus{}MC} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{trn\PYZus{}col} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{columns}
         \PY{n}{tst\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{trn\PYZus{}col}\PY{p}{:}
             \PY{n}{RMSE\PYZus{}MC}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{knn\PYZus{}train\PYZus{}test\PYZus{}splits}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{n}{tst\PYZus{}col}\PY{p}{,} \PY{n}{cars\PYZus{}num}\PY{p}{)}
         
         \PY{n}{RMSE\PYZus{}MC}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} \{'bore': \{1: 16584.92378245978,
           3: 13996.721161043395,
           5: 13420.66013722127,
           7: 11079.213535955796,
           9: 10217.599521613385\},
          'city-mpg': \{1: 5365.433446609883,
           3: 5234.360540484174,
           5: 4796.381435749246,
           7: 4579.778132559413,
           9: 4743.612991690856\},
          'compression-rate': \{1: 8125.434180399223,
           3: 8178.550223059776,
           5: 8136.40761621491,
           7: 7934.111996902223,
           9: 7856.87625370601\},
          'curb-weight': \{1: 6506.062797114703,
           3: 5618.008230878825,
           5: 5164.381316866522,
           7: 5245.599869783965,
           9: 5228.853464251726\},
          'height': \{1: 13086.66478901328,
           3: 11351.195125967035,
           5: 10835.39508699152,
           7: 9957.21417984294,
           9: 9258.219431789274\},
          'highway-mpg': \{1: 5095.432138690496,
           3: 4500.45206963824,
           5: 4398.904134031566,
           7: 3911.670503683529,
           9: 3718.106564511261\},
          'horsepower': \{1: 7062.084135720843,
           3: 5424.37770347899,
           5: 4182.751064168175,
           7: 3861.016243484218,
           9: 3503.520831998422\},
          'length': \{1: 10295.140528909744,
           3: 8388.354331982458,
           5: 8304.747817098361,
           7: 8190.342248499205,
           9: 7620.134422350525\},
          'normalized-losses': \{1: 11951.82024421385,
           3: 10023.50956878655,
           5: 8443.070564077978,
           7: 7500.093728489162,
           9: 7638.045516110313\},
          'peak-rpm': \{1: 10968.678615494211,
           3: 11263.00163026417,
           5: 9454.169136439225,
           7: 9495.13848893641,
           9: 9508.025552742532\},
          'stroke': \{1: 10980.078241979882,
           3: 11907.399436811456,
           5: 9383.411544614251,
           7: 8295.568471005641,
           9: 7825.851999780543\},
          'wheel-base': \{1: 8091.709810664245,
           3: 9216.785562102321,
           5: 10016.733728895862,
           7: 8978.328387232203,
           9: 8674.610712274423\},
          'width': \{1: 8616.242079352227,
           3: 8004.028103745985,
           5: 7744.931063502115,
           7: 7126.92195030325,
           9: 6761.684721627543\}\}
\end{Verbatim}
            
    \subsubsection{Plot the Univariate Multicluster Model
Results}\label{plot-the-univariate-multicluster-model-results}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{} Developing the plot series}
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{RMSE\PYZus{}MC}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{X} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{y} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cluster Number}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RMSE}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{K\PYZhy{}Nearest Neighbors Univariate Model Results}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Develop Multivariate Model (Default
Clusters)}\label{develop-multivariate-model-default-clusters}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{} Develop Multivariate Model with Single Default Neighbor Value as 5 from scikit\PYZhy{}learn}
         
         \PY{k}{def} \PY{n+nf}{knn\PYZus{}train\PYZus{}test\PYZus{}mv}\PY{p}{(}\PY{n}{train\PYZus{}col}\PY{p}{,} \PY{n}{test\PYZus{}col}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}    
         
         \PY{c+c1}{\PYZsh{} Randomize the data }
             \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{shuflled\PYZus{}idx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}
             \PY{n}{data\PYZus{}rand} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{reindex}\PY{p}{(}\PY{n}{shuflled\PYZus{}idx}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Divide the data set 50/50 between the training and test set }
             \PY{n}{break\PYZus{}pt} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
             \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{data\PYZus{}rand}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n}{break\PYZus{}pt}\PY{p}{]}
             \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{data\PYZus{}rand}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{break\PYZus{}pt}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
             
         \PY{c+c1}{\PYZsh{} Defining the Training and Test Set}
             \PY{n}{train\PYZus{}features} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}
             \PY{n}{train\PYZus{}target} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
             \PY{n}{test\PYZus{}features} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}
             \PY{n}{test\PYZus{}target} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Develop KNeighbor Regression}
             \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{p}{)}     
             \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}features}\PY{p}{,} \PY{n}{train\PYZus{}target}\PY{p}{)}
             \PY{n}{predictions} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}features}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Calculate the model error matrix}
             \PY{n}{mse\PYZus{}val} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{test\PYZus{}target}\PY{p}{,} \PY{n}{predictions}\PY{p}{)}
             \PY{n}{rmse} \PY{o}{=} \PY{n}{m}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mse\PYZus{}val}\PY{p}{)}
             \PY{k}{return} \PY{n}{rmse}
         
         \PY{c+c1}{\PYZsh{} Trying different best features and verify how RMSE varies }
         \PY{c+c1}{\PYZsh{} To identify the preference of top 5 best features, let\PYZsq{}s extract }
         \PY{c+c1}{\PYZsh{} the RMSE value in ascending order from the previous Univariate Model}
         
         \PY{n}{best\PYZus{}features} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{RMSE\PYZus{}MC}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{best\PYZus{}features}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{top5\PYZus{}nn} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{best\PYZus{}features}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{n}{itemgetter}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{top5\PYZus{}nn}\PY{p}{)}
         
         \PY{n}{rmse\PYZus{}mv} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{two\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{three\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{four\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{five\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{six\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{compression\PYZhy{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{rmse\PYZus{}mv\PYZus{}keys} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{two\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{three\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{four\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{five\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{six\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{rmse\PYZus{}mv\PYZus{}vals} \PY{o}{=} \PY{p}{[}\PY{n}{two\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{three\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{four\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{five\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{six\PYZus{}best\PYZus{}features}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{rmse\PYZus{}mv\PYZus{}keys}\PY{p}{)}\PY{p}{)}\PY{p}{:}
             \PY{n}{rmse\PYZus{}mv}\PY{p}{[}\PY{n}{rmse\PYZus{}mv\PYZus{}keys}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{knn\PYZus{}train\PYZus{}test\PYZus{}mv}\PY{p}{(}\PY{n}{rmse\PYZus{}mv\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cars\PYZus{}num}\PY{p}{)}
             
         \PY{n}{rmse\PYZus{}mv}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[('highway-mpg', 4324.913082111018), ('horsepower', 4806.74999577013), ('city-mpg', 4943.913309418715), ('curb-weight', 5552.581135779148), ('width', 7650.761583706224), ('compression-rate', 8046.276054056429), ('length', 8559.743869768059), ('wheel-base', 8995.63364023381), ('normalized-losses', 9111.30792433557), ('stroke', 9678.461938838354), ('peak-rpm', 10137.80268477531), ('height', 10897.737722720809), ('bore', 13059.823627658723)]

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:} \{'five\_best\_features': 3354.768120153761,
          'four\_best\_features': 3497.917667698884,
          'six\_best\_features': 3542.0349199295024,
          'three\_best\_features': 3353.1645428758793,
          'two\_best\_features': 3280.770311801788\}
\end{Verbatim}
            
    \subsubsection{Multivariate Model With Multiple
Clusters}\label{multivariate-model-with-multiple-clusters}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{} Develop Multivariate Model with Multiple Neighbor Values Using the Top 6 Best Features from above}
         
         \PY{k}{def} \PY{n+nf}{knn\PYZus{}train\PYZus{}test\PYZus{}mvc}\PY{p}{(}\PY{n}{train\PYZus{}col}\PY{p}{,} \PY{n}{test\PYZus{}col}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}    
         
         \PY{c+c1}{\PYZsh{} Randomize the data }
             \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{shuflled\PYZus{}idx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}
             \PY{n}{data\PYZus{}rand} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{reindex}\PY{p}{(}\PY{n}{shuflled\PYZus{}idx}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Divide the data set 50/50 between the training and test set }
             \PY{n}{break\PYZus{}pt} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
             \PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{data\PYZus{}rand}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n}{break\PYZus{}pt}\PY{p}{]}
             \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{data\PYZus{}rand}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{break\PYZus{}pt}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}    
         
         \PY{c+c1}{\PYZsh{} Defining the Training and Test Set}
             \PY{n}{train\PYZus{}features} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}
             \PY{n}{train\PYZus{}target} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
             \PY{n}{test\PYZus{}features} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}
             \PY{n}{test\PYZus{}target} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Defining the cluster values from 1 \PYZhy{} 25}
             \PY{n}{k\PYZus{}val} \PY{o}{=} \PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{]}
             \PY{n}{rmse\PYZus{}val\PYZus{}mvc} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
             
         \PY{c+c1}{\PYZsh{} Develop KNeighbor Regression}
             \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n}{k\PYZus{}val}\PY{p}{:}
                 \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{n}{n\PYZus{}neighbors} \PY{o}{=} \PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}     
                 \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}features}\PY{p}{,} \PY{n}{train\PYZus{}target}\PY{p}{)}
                 \PY{n}{predictions} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}features}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Calculate the model error matrix}
                 \PY{n}{mse\PYZus{}val\PYZus{}mvc} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{test\PYZus{}target}\PY{p}{,} \PY{n}{predictions}\PY{p}{)}
                 \PY{n}{rmse\PYZus{}val\PYZus{}mvc}\PY{p}{[}\PY{n}{k} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{m}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mse\PYZus{}val\PYZus{}mvc}\PY{p}{)}
             \PY{k}{return} \PY{n}{rmse\PYZus{}val\PYZus{}mvc}
         
         \PY{n}{rmse\PYZus{}mvc} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{two\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{three\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{four\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{five\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{six\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{compression\PYZhy{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{rmse\PYZus{}mvc\PYZus{}keys} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{two\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{three\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{four\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{five\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{six\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{rmse\PYZus{}mvc\PYZus{}vals} \PY{o}{=} \PY{p}{[}\PY{n}{two\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{three\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{four\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{five\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{six\PYZus{}best\PYZus{}features}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{rmse\PYZus{}mvc\PYZus{}keys}\PY{p}{)}\PY{p}{)}\PY{p}{:}
             \PY{n}{rmse\PYZus{}mvc}\PY{p}{[}\PY{n}{rmse\PYZus{}mvc\PYZus{}keys}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{knn\PYZus{}train\PYZus{}test\PYZus{}mvc}\PY{p}{(}\PY{n}{rmse\PYZus{}mvc\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cars\PYZus{}num}\PY{p}{)}
             
         \PY{n}{rmse\PYZus{}mvc}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:} \{'five\_best\_features': \{1: 2522.34322803222,
           2: 2901.265709565396,
           3: 3194.7981612476106,
           4: 3179.8159698125614,
           5: 3354.768120153761,
           6: 3554.219122903245,
           7: 3835.365094826338,
           8: 4023.857588049837,
           9: 4011.8186578325463,
           10: 4159.130326354297,
           11: 4363.387571221952,
           12: 4437.940498042607,
           13: 4516.051228751735,
           14: 4485.415098427801,
           15: 4496.478315936694,
           16: 4575.928353273997,
           17: 4619.454166523248,
           18: 4678.060992505203,
           19: 4710.954185222263,
           20: 4735.107799200563,
           21: 4779.058044867539,
           22: 4811.659056250249,
           23: 4830.614628012334,
           24: 4903.95236785043,
           25: 4948.054413629665\},
          'four\_best\_features': \{1: 2726.3392488830145,
           2: 2686.8332410106887,
           3: 3053.8303944027048,
           4: 3140.17829688857,
           5: 3497.917667698884,
           6: 3812.048222339854,
           7: 3975.2003164004454,
           8: 4134.100658603846,
           9: 4354.96304487446,
           10: 4461.40887272171,
           11: 4583.420441228841,
           12: 4645.517198952543,
           13: 4732.750936891872,
           14: 4682.136018819241,
           15: 4721.437077595007,
           16: 4739.036601157389,
           17: 4675.760410159827,
           18: 4685.1937887572885,
           19: 4765.525999904079,
           20: 4766.812732518448,
           21: 4804.353110482626,
           22: 4777.348096200728,
           23: 4812.925938989358,
           24: 4868.485129423389,
           25: 4894.183427872723\},
          'six\_best\_features': \{1: 2538.4777052398945,
           2: 2924.6141501914403,
           3: 3219.4941802504736,
           4: 3128.693080584927,
           5: 3542.0349199295024,
           6: 3785.0061070330894,
           7: 3947.2993226834396,
           8: 4163.821567326252,
           9: 4204.946471217258,
           10: 4374.062519054797,
           11: 4476.530484843764,
           12: 4610.950479308891,
           13: 4634.299160153433,
           14: 4668.066965767281,
           15: 4696.9484222654855,
           16: 4786.570710184249,
           17: 4796.05119509285,
           18: 4841.6860291478715,
           19: 4901.528662231396,
           20: 4859.5147476317015,
           21: 4894.557734298004,
           22: 4971.79654319457,
           23: 5019.791601839455,
           24: 5075.9531785621175,
           25: 5109.0777740034455\},
          'three\_best\_features': \{1: 3799.769910139297,
           2: 3404.7266545935813,
           3: 3299.680963366003,
           4: 3175.940592564666,
           5: 3353.1645428758793,
           6: 3578.5343852461287,
           7: 3677.877630412099,
           8: 3987.164656392748,
           9: 4266.181276759444,
           10: 4325.012368618152,
           11: 4329.087107344366,
           12: 4514.762731076426,
           13: 4685.552416611788,
           14: 4792.746961837655,
           15: 4948.364890039717,
           16: 5088.9756313241405,
           17: 5183.157343472917,
           18: 5243.67548595213,
           19: 5252.323817410374,
           20: 5274.804570813501,
           21: 5315.959357356891,
           22: 5340.986903057933,
           23: 5411.307325656456,
           24: 5355.620460655679,
           25: 5377.999202860484\},
          'two\_best\_features': \{1: 4069.5789892813236,
           2: 3296.250909745798,
           3: 3059.664965137341,
           4: 3086.983107035897,
           5: 3280.770311801788,
           6: 3486.6901349592595,
           7: 3710.1524880373577,
           8: 4028.4231578171502,
           9: 4212.909096931993,
           10: 4373.115326240551,
           11: 4548.201200102252,
           12: 4634.007734132519,
           13: 4699.956358534638,
           14: 4820.089955131671,
           15: 4971.794442497039,
           16: 5105.347339761456,
           17: 5199.833188440995,
           18: 5222.006810306045,
           19: 5248.867052278337,
           20: 5238.98718269333,
           21: 5258.264146380113,
           22: 5259.896089833629,
           23: 5276.498097004657,
           24: 5335.944753816446,
           25: 5379.758333683029\}\}
\end{Verbatim}
            
    \subsubsection{Plot the Multivariate Multicluster Model
Result}\label{plot-the-multivariate-multicluster-model-result}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{} Developing the plot series}
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{rmse\PYZus{}mvc}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{X} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{y} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cluster Number}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RMSE}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{K\PYZhy{}Nearest Neighbors Multivariate Model Results}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    Let's improve model performance by using KFold Cross Validation Method.
    \subsubsection{Develop Univariate Model Using KFold Cross
Validation}\label{develop-univariate-model-using-kfold-cross-validation}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{} Develop Univariate KFold Model with default Split Value and default number of neighbors from scikit\PYZhy{}learn}
         
         \PY{k}{def} \PY{n+nf}{kfold\PYZus{}train\PYZus{}test}\PY{p}{(}\PY{n}{train\PYZus{}col}\PY{p}{,} \PY{n}{test\PYZus{}col}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}    
             
         \PY{c+c1}{\PYZsh{} Divide the data set 50/50 between the training and test set \PYZam{} randomize the data}
             \PY{n}{kfd} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits} \PY{o}{=} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Develop KNeighbor Regression}
             \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}
             \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index}\PY{p}{,} \PY{o+ow}{in} \PY{n}{kfd}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
                 \PY{n}{train\PYZus{}kf} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}
                 \PY{n}{test\PYZus{}kf} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
                     
                 \PY{n}{train\PYZus{}features} \PY{o}{=} \PY{n}{train\PYZus{}kf}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
                 \PY{n}{train\PYZus{}target} \PY{o}{=} \PY{n}{train\PYZus{}kf}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
                 \PY{n}{test\PYZus{}features} \PY{o}{=} \PY{n}{test\PYZus{}kf}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
                 \PY{n}{test\PYZus{}target} \PY{o}{=} \PY{n}{test\PYZus{}kf}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
                     
                 \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}features}\PY{p}{,} \PY{n}{train\PYZus{}target}\PY{p}{)}
                 \PY{n}{predictions} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}features}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Calculate the model error matrix}
             
                 \PY{n}{mse\PYZus{}val\PYZus{}kfd} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{test\PYZus{}target}\PY{p}{,} \PY{n}{predictions}\PY{p}{)}
                 \PY{n}{rmse\PYZus{}val\PYZus{}kfd} \PY{o}{=} \PY{n}{m}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mse\PYZus{}val\PYZus{}kfd}\PY{p}{)}
             \PY{k}{return} \PY{n}{rmse\PYZus{}val\PYZus{}kfd}
         
         \PY{n}{trn\PYZus{}col} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{columns}
         \PY{n}{tst\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{rmse\PYZus{}val\PYZus{}kfd} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{trn\PYZus{}col}\PY{p}{:}
             \PY{n}{rmse\PYZus{}val\PYZus{}kfd}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{kfold\PYZus{}train\PYZus{}test}\PY{p}{(}\PY{n}{col}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cars\PYZus{}num}\PY{p}{)}
         \PY{n}{rmse\PYZus{}val\PYZus{}kfd}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:} \{'bore': 5315.196622470554,
          'city-mpg': 3970.033239907463,
          'compression-rate': 5887.687591180707,
          'curb-weight': 3501.748088146236,
          'height': 8786.4885851355,
          'highway-mpg': 5220.101166058049,
          'horsepower': 3046.2973485072644,
          'length': 5788.265244775899,
          'normalized-losses': 7441.517813641668,
          'peak-rpm': 7973.661074521746,
          'stroke': 6494.111632741422,
          'wheel-base': 5116.804072506383,
          'width': 5293.788718133621\}
\end{Verbatim}
            
    \subsubsection{Univariate Model Using KFold Cross Validation with
Multiple
Clusters}\label{univariate-model-using-kfold-cross-validation-with-multiple-clusters}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{} Set up a KFold cross validation that develop model with multiple clusters, 5 data folds and return RMSE}
         \PY{n}{clusters} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{]}
         
         \PY{k}{def} \PY{n+nf}{kfold\PYZus{}train\PYZus{}test\PYZus{}mc}\PY{p}{(}\PY{n}{train\PYZus{}col}\PY{p}{,} \PY{n}{test\PYZus{}col}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}    
             
         \PY{c+c1}{\PYZsh{} Divide the data set between the training and test set \PYZam{} randomize the data}
             \PY{n}{kfd} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{kfold\PYZus{}rmse} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{rmse\PYZus{}kfd} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{c+c1}{\PYZsh{} Develop KNeighbor Regression.}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{clusters}\PY{p}{:}
                 \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=}\PY{n}{i}\PY{p}{)}
                 \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index}\PY{p}{,} \PY{o+ow}{in} \PY{n}{kfd}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
                     \PY{n}{train\PYZus{}kf} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}
                     \PY{n}{test\PYZus{}kf} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
                     
                     \PY{n}{train\PYZus{}features} \PY{o}{=} \PY{n}{train\PYZus{}kf}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
                     \PY{n}{train\PYZus{}target} \PY{o}{=} \PY{n}{train\PYZus{}kf}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
                     \PY{n}{test\PYZus{}features} \PY{o}{=} \PY{n}{test\PYZus{}kf}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
                     \PY{n}{test\PYZus{}target} \PY{o}{=} \PY{n}{test\PYZus{}kf}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
                     
                     \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}features}\PY{p}{,} \PY{n}{train\PYZus{}target}\PY{p}{)}
                     \PY{n}{predictions} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}features}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Calculate the model error matrix  }
                     \PY{n}{mse\PYZus{}val\PYZus{}kfd} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{test\PYZus{}target}\PY{p}{,} \PY{n}{predictions}\PY{p}{)}
                     \PY{n}{kfold\PYZus{}rmse}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{m}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mse\PYZus{}val\PYZus{}kfd}\PY{p}{)}\PY{p}{)}
                 \PY{n}{rmse\PYZus{}kfd}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{kfold\PYZus{}rmse}\PY{p}{)}
             \PY{k}{return} \PY{n}{rmse\PYZus{}kfd}
         
         \PY{n}{trn\PYZus{}col} \PY{o}{=} \PY{n}{cars\PYZus{}num}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{columns}
         \PY{n}{tst\PYZus{}col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{rmse\PYZus{}kfd\PYZus{}mc} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{trn\PYZus{}col}\PY{p}{:}
             \PY{n}{rmse\PYZus{}kfd\PYZus{}mc}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{kfold\PYZus{}train\PYZus{}test\PYZus{}mc}\PY{p}{(}\PY{n}{col}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cars\PYZus{}num}\PY{p}{)}
         \PY{n}{rmse\PYZus{}kfd\PYZus{}mc}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:} \{'bore': \{1: 8327.580323142378,
           3: 7720.6813663367575,
           5: 7492.325530997303,
           7: 7374.399857383169,
           9: 7352.568758535477\},
          'city-mpg': \{1: 5828.667481490455,
           3: 5168.2724354332095,
           5: 4938.520978279707,
           7: 4859.184409918129,
           9: 4820.060025184927\},
          'compression-rate': \{1: 7454.196136549045,
           3: 6754.529212345032,
           5: 6537.510448639073,
           7: 6467.330432243976,
           9: 6437.81121532997\},
          'curb-weight': \{1: 5085.238679780281,
           3: 4804.846374645145,
           5: 4554.712194791633,
           7: 4435.020606905218,
           9: 4363.053844653614\},
          'height': \{1: 9973.755654217723,
           3: 9221.338751721212,
           5: 8768.746580435898,
           7: 8507.875765205785,
           9: 8329.161769481676\},
          'highway-mpg': \{1: 5048.597895835071,
           3: 4735.764950214003,
           5: 4535.664067908839,
           7: 4507.060816581736,
           9: 4433.2881070163685\},
          'horsepower': \{1: 3812.5600141720306,
           3: 3820.459679685042,
           5: 3767.518513405144,
           7: 3881.778373023022,
           9: 3960.244843781488\},
          'length': \{1: 5527.271226810661,
           3: 5401.698797360317,
           5: 5322.310785736173,
           7: 5471.055077313072,
           9: 5475.90951502706\},
          'normalized-losses': \{1: 7025.474989283388,
           3: 6781.831129144508,
           5: 6975.020555416428,
           7: 6954.86055970077,
           9: 6994.240269971826\},
          'peak-rpm': \{1: 9048.768851047611,
           3: 8548.007972277152,
           5: 8206.705945749827,
           7: 8058.816957346031,
           9: 7976.49526761935\},
          'stroke': \{1: 8822.554705097678,
           3: 8035.706924006006,
           5: 7762.252454332899,
           7: 7659.684430701302,
           9: 7592.209381424959\},
          'wheel-base': \{1: 4660.672666772243,
           3: 4935.564645168429,
           5: 5152.369687718226,
           7: 5357.7380743761005,
           9: 5477.7092437934025\},
          'width': \{1: 4890.756592218648,
           3: 4648.868058891875,
           5: 4569.99425459647,
           7: 4633.839322926813,
           9: 4624.431609367567\}\}
\end{Verbatim}
            
    \subsubsection{Plot Univariate Multicluster Kfold Cross Validation
Result}\label{plot-univariate-multicluster-kfold-cross-validation-result}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{} Developing the Kfold plot series}
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{rmse\PYZus{}kfd\PYZus{}mc}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{X} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{y} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cluster Number}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RMSE}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Kfold Univariate Model Results}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_39_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Identify the Top 5 Best Features from KFold Cross
Validation}\label{identify-the-top-5-best-features-from-kfold-cross-validation}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{best\PYZus{}kfd\PYZus{}features} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{rmse\PYZus{}kfd\PYZus{}mc}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{best\PYZus{}kfd\PYZus{}features}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Print features in ascending order of error values}
         \PY{n}{top5\PYZus{}kfd} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{best\PYZus{}kfd\PYZus{}features}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{n}{itemgetter}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{top5\PYZus{}kfd}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[('horsepower', 3848.5122848133456), ('curb-weight', 4648.574340155178), ('highway-mpg', 4652.075167511202), ('width', 4673.577967600274), ('wheel-base', 5116.810863565681), ('city-mpg', 5122.941066061286), ('length', 5439.649080449456), ('compression-rate', 6730.275489021418), ('normalized-losses', 6946.285500703384), ('bore', 7653.511167279017), ('stroke', 7974.481579112568), ('peak-rpm', 8367.758998807994), ('height', 8960.17570421246)]

    \end{Verbatim}

    \subsubsection{Multivariate KFold Cross Validation With Multiple
Clusters}\label{multivariate-kfold-cross-validation-with-multiple-clusters}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{} Set up a KFold cross validation that develop model with multiple clusters, 10 data folds and return RMSE}
         \PY{n}{clusters\PYZus{}mvmc} \PY{o}{=} \PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{26}\PY{p}{)}\PY{p}{]}
         
         \PY{k}{def} \PY{n+nf}{kfold\PYZus{}train\PYZus{}test\PYZus{}mvmc}\PY{p}{(}\PY{n}{train\PYZus{}col}\PY{p}{,} \PY{n}{test\PYZus{}col}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}    
             
         \PY{c+c1}{\PYZsh{} Divide the data set between the training and test set \PYZam{} randomize the data}
             \PY{n}{kfd} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{kfold\PYZus{}rmse\PYZus{}mvmc} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{rmse\PYZus{}kfd\PYZus{}mvmc} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{c+c1}{\PYZsh{} Develop KNeighbor Regression }
             \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n}{clusters\PYZus{}mvmc}\PY{p}{:}
                 \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsRegression}\PY{p}{(}\PY{n}{n\PYZus{}neighbors}\PY{o}{=} \PY{n}{k}\PY{p}{)}
                 \PY{k}{for} \PY{n}{train\PYZus{}index}\PY{p}{,} \PY{n}{test\PYZus{}index}\PY{p}{,} \PY{o+ow}{in} \PY{n}{kfd}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
                     \PY{n}{train\PYZus{}kf} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{train\PYZus{}index}\PY{p}{]}
                     \PY{n}{test\PYZus{}kf} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{test\PYZus{}index}\PY{p}{]}
                     
                     \PY{n}{train\PYZus{}features} \PY{o}{=} \PY{n}{train\PYZus{}kf}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
                     \PY{n}{train\PYZus{}target} \PY{o}{=} \PY{n}{train\PYZus{}kf}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
                     \PY{n}{test\PYZus{}features} \PY{o}{=} \PY{n}{test\PYZus{}kf}\PY{p}{[}\PY{p}{[}\PY{n}{train\PYZus{}col}\PY{p}{]}\PY{p}{]}
                     \PY{n}{test\PYZus{}target} \PY{o}{=} \PY{n}{test\PYZus{}kf}\PY{p}{[}\PY{n}{test\PYZus{}col}\PY{p}{]}
                     
                     \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{train\PYZus{}features}\PY{p}{,} \PY{n}{train\PYZus{}target}\PY{p}{)}
                     \PY{n}{predictions} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{test\PYZus{}features}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Calculate the model error matrix  }
                     \PY{n}{mse\PYZus{}val\PYZus{}mvmc} \PY{o}{=} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{(}\PY{n}{test\PYZus{}target}\PY{p}{,} \PY{n}{predictions}\PY{p}{)}
                     \PY{n}{kfold\PYZus{}rmse\PYZus{}mvmc}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{m}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{mse\PYZus{}val\PYZus{}mvmc}\PY{p}{)}\PY{p}{)}
                 \PY{n}{rmse\PYZus{}kfd\PYZus{}mvmc}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{kfold\PYZus{}rmse\PYZus{}mvmc}\PY{p}{)}
             \PY{k}{return} \PY{n}{rmse\PYZus{}kfd\PYZus{}mvmc}
         
         \PY{n}{rmse\PYZus{}mvmc} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{two\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{three\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{four\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{five\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{six\PYZus{}best\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horsepower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{curb\PYZhy{}weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{city\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{highway\PYZhy{}mpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wheel\PYZhy{}base}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{rmse\PYZus{}mvmc\PYZus{}keys} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{two\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{three\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{four\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{five\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{six\PYZus{}best\PYZus{}features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{rmse\PYZus{}mvmc\PYZus{}vals} \PY{o}{=} \PY{p}{[}\PY{n}{two\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{three\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{four\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{five\PYZus{}best\PYZus{}features}\PY{p}{,} \PY{n}{six\PYZus{}best\PYZus{}features}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{rmse\PYZus{}mvmc\PYZus{}keys}\PY{p}{)}\PY{p}{)}\PY{p}{:}
             \PY{n}{rmse\PYZus{}mvmc}\PY{p}{[}\PY{n}{rmse\PYZus{}mvmc\PYZus{}keys}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{knn\PYZus{}train\PYZus{}test\PYZus{}mvc}\PY{p}{(}\PY{n}{rmse\PYZus{}mvmc\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cars\PYZus{}num}\PY{p}{)}
         
         \PY{n}{rmse\PYZus{}mvmc}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} \{'five\_best\_features': \{1: 2522.34322803222,
           2: 2901.265709565396,
           3: 3194.7981612476106,
           4: 3179.8159698125614,
           5: 3354.768120153761,
           6: 3554.219122903245,
           7: 3835.365094826338,
           8: 4023.857588049837,
           9: 4011.8186578325463,
           10: 4159.130326354297,
           11: 4363.387571221952,
           12: 4437.940498042607,
           13: 4516.051228751735,
           14: 4485.415098427801,
           15: 4496.478315936694,
           16: 4575.928353273997,
           17: 4619.454166523248,
           18: 4678.060992505203,
           19: 4710.954185222263,
           20: 4735.107799200563,
           21: 4779.058044867539,
           22: 4811.659056250249,
           23: 4830.614628012334,
           24: 4903.95236785043,
           25: 4948.054413629665\},
          'four\_best\_features': \{1: 2508.700263084452,
           2: 2825.099184984485,
           3: 3027.53402953625,
           4: 3141.306046356356,
           5: 3296.1910519871267,
           6: 3496.133159291848,
           7: 3799.5898375847823,
           8: 4007.828333730906,
           9: 4043.7752590925943,
           10: 4061.585955153479,
           11: 4250.79245548248,
           12: 4375.286951938759,
           13: 4483.370742747367,
           14: 4489.915257063572,
           15: 4465.819253360897,
           16: 4514.011766770981,
           17: 4619.620820963662,
           18: 4637.760207681141,
           19: 4715.269069975908,
           20: 4750.881405165783,
           21: 4761.378934168045,
           22: 4801.650405910296,
           23: 4835.278211081895,
           24: 4870.355670638882,
           25: 4905.289873639682\},
          'six\_best\_features': \{1: 2903.4532043757827,
           2: 3142.0018968803947,
           3: 3396.8392455340004,
           4: 3590.8558216496244,
           5: 3725.481343021328,
           6: 3763.0956998342617,
           7: 4018.294441066015,
           8: 4119.172252994981,
           9: 4172.055347099227,
           10: 4371.63023444344,
           11: 4457.404384164281,
           12: 4445.475644014685,
           13: 4470.007393710047,
           14: 4536.375387630525,
           15: 4661.429680106499,
           16: 4708.5231406809635,
           17: 4716.842957763243,
           18: 4709.737146383511,
           19: 4741.016094269443,
           20: 4789.170634956015,
           21: 4827.856239976242,
           22: 4861.782713820617,
           23: 4899.037844053352,
           24: 4933.098839716593,
           25: 5011.346646521272\},
          'three\_best\_features': \{1: 3015.5526093901926,
           2: 2827.2230399280493,
           3: 3185.8503572655272,
           4: 3196.0885968242496,
           5: 3321.910837816091,
           6: 3539.8708979911185,
           7: 3793.0856521425662,
           8: 3998.8041253370366,
           9: 4012.833999083133,
           10: 4096.527942160287,
           11: 4176.949918321417,
           12: 4221.982450413221,
           13: 4325.052659466676,
           14: 4381.325736607027,
           15: 4393.354922111853,
           16: 4416.152056677319,
           17: 4532.682224970172,
           18: 4606.920384749421,
           19: 4659.545413256474,
           20: 4687.480138640591,
           21: 4747.607147042925,
           22: 4776.151009226352,
           23: 4832.640363945995,
           24: 4883.133452450838,
           25: 4928.990953226837\},
          'two\_best\_features': \{1: 2802.056360960643,
           2: 2712.806615850087,
           3: 3015.006126951578,
           4: 3121.398744653589,
           5: 3273.867152710996,
           6: 3677.646990490885,
           7: 3794.1271291622397,
           8: 4009.539237614311,
           9: 4126.992051493002,
           10: 4314.186932632845,
           11: 4468.543354706605,
           12: 4496.775761425253,
           13: 4558.046484044459,
           14: 4580.507460964231,
           15: 4649.5206564930495,
           16: 4639.7379678714415,
           17: 4650.666519701671,
           18: 4614.284748928866,
           19: 4625.033325282348,
           20: 4632.395383133331,
           21: 4666.650528395322,
           22: 4676.108846142386,
           23: 4721.055147421024,
           24: 4761.630442851292,
           25: 4784.2029310003145\}\}
\end{Verbatim}
            
    \subsubsection{Plot Multivariate Multicluster KFold Cross Validation
Result}\label{plot-multivariate-multicluster-kfold-cross-validation-result}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{c+c1}{\PYZsh{} Developing the Kfold plot series}
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{rmse\PYZus{}mvmc}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{X} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{y} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cluster Number}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RMSE}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Kfold Multivariate Model Results}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Compare Results of Two Different Model
Approaches}\label{compare-results-of-two-different-model-approaches}

    \paragraph{Univariate Model Errors}\label{univariate-model-errors}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{UVE} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}dict}\PY{p}{(}\PY{n}{rmse\PYZus{}dict}\PY{p}{,} \PY{n}{orient}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{UVE}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Nearest Neighbors}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{UVE}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{KFold}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}dict}\PY{p}{(}\PY{n}{rmse\PYZus{}val\PYZus{}kfd}\PY{p}{,} \PY{n}{orient}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{uve\PYZus{}delta} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n}{UVE}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KFold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{UVE}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nearest Neighbors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{UVE}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nearest Neighbors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Overall change in the error matrix = }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{uve\PYZus{}delta}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{UVE}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Overall change in the error matrix = -6.31\%


    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:}                    Nearest Neighbors        KFold
         normalized-losses        7338.850271  7441.517814
         wheel-base               5486.805327  5116.804073
         length                   5455.571648  5788.265245
         width                    4931.242156  5293.788718
         height                   7857.627254  8786.488585
         curb-weight              4422.255746  3501.748088
         bore                     6822.548760  5315.196622
         stroke                   7965.733340  6494.111633
         compression-rate         6628.568723  5887.687591
         horsepower               4011.999336  3046.297349
         peak-rpm                 7698.121919  7973.661075
         city-mpg                 4998.449685  3970.033240
         highway-mpg              4675.883732  5220.101166
\end{Verbatim}
            
    \paragraph{Multivariate Model Errors for
Multiclusters}\label{multivariate-model-errors-for-multiclusters}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{multiclusters\PYZus{}nn} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{mutliclusters\PYZus{}kfd} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{RMSE\PYZus{}MC}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{multiclusters\PYZus{}nn}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{rmse\PYZus{}kfd\PYZus{}mc}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{mutliclusters\PYZus{}kfd}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{MCE} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}dict}\PY{p}{(}\PY{n}{multiclusters\PYZus{}nn}\PY{p}{,} \PY{n}{orient}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{MCE}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Nearest Neighbors}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{MCE}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{KFold}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}dict}\PY{p}{(}\PY{n}{mutliclusters\PYZus{}kfd}\PY{p}{,} \PY{n}{orient}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{mce\PYZus{}delta} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n}{MCE}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KFold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{MCE}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nearest Neighbors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{MCE}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nearest Neighbors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Overall change in the error matrix = }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{mce\PYZus{}delta}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{MCE}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Overall change in the error matrix = -21.37\%


    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:}                    Nearest Neighbors        KFold
         normalized-losses        9111.307924  6946.285501
         wheel-base               8995.633640  5116.810864
         length                   8559.743870  5439.649080
         width                    7650.761584  4673.577968
         height                  10897.737723  8960.175704
         curb-weight              5552.581136  4648.574340
         bore                    13059.823628  7653.511167
         stroke                   9678.461939  7974.481579
         compression-rate         8046.276054  6730.275489
         horsepower               4806.749996  3848.512285
         peak-rpm                10137.802685  8367.758999
         city-mpg                 4943.913309  5122.941066
         highway-mpg              4324.913082  4652.075168
\end{Verbatim}
            
    \paragraph{Multivariate Model Errors for Top 5 Best
Features}\label{multivariate-model-errors-for-top-5-best-features}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{c+c1}{\PYZsh{} Getting the average value of each of the top 5 best features}
         \PY{n}{multivariate\PYZus{}nn} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{mutlivariate\PYZus{}kfd} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{rmse\PYZus{}mvc}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{multivariate\PYZus{}nn}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n}{rmse\PYZus{}mvmc}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{mutlivariate\PYZus{}kfd}\PY{p}{[}\PY{n}{k}\PY{p}{]} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{v}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{MVE} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}dict}\PY{p}{(}\PY{n}{multivariate\PYZus{}nn}\PY{p}{,} \PY{n}{orient}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{MVE}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Nearest Neighbors}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n}{MVE}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{KFold}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}dict}\PY{p}{(}\PY{n}{mutlivariate\PYZus{}kfd}\PY{p}{,} \PY{n}{orient}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{mve\PYZus{}delta} \PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n}{MVE}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KFold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{MVE}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nearest Neighbors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{MVE}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nearest Neighbors}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Overall change in the error matrix = }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{mve\PYZus{}delta}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{MVE}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Overall change in the error matrix = -3.82\%


    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}26}]:}                      Nearest Neighbors        KFold
         two\_best\_features          4512.159647  4174.911476
         three\_best\_features        4519.335087  4142.308676
         four\_best\_features         4279.908275  4147.376966
         five\_best\_features         4185.179948  4185.179948
         six\_best\_features          4326.870948  4318.879369
\end{Verbatim}
            
    \subsubsection{Conclusion}\label{conclusion}
We can summarize our findings from the project outcome as: 

1.	Reducing the data noise by eliminating the data gaps, 
2.	effective data cleaning with proper understanding of the data, 
3.	filling out the missing data properly feature mean values, 
4.	careful selection of various features of high significance value, 
5.	reasonably increasing the number data points/clusters, and 
6.	use of proper model validation technique

can help to improve the predictive models accuracy for care sale price. 

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
